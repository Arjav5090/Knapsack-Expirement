"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[302],{1302:function(e,t,s){s.r(t),s.d(t,{default:function(){return b}});var a=s(7437),l=s(2265),i=s(9374),c=s(6070),n=s(5974),r=s(2759),o=s(1239),d=s(8896),u=s(1671),m=s(9388),h=s(8614),x=s(8239),g=s(8415),p=s(9116),f=s(9608),y=s(9762),j=s(257);function b(e){let{onNext:t,updateParticipantData:s}=e,[b,N]=(0,l.useState)(0),[w,v]=(0,l.useState)([]),[P,k]=(0,l.useState)(!1),[q,S]=(0,l.useState)(null),[C,E]=(0,l.useState)(!0),[I,T]=(0,l.useState)(null),[z,L]=(0,l.useState)(!1),[Z,D]=(0,l.useState)([]),[Q,F]=(0,l.useState)(!0),[Y,R]=(0,l.useState)(null),[_,W]=(0,l.useState)(null);(0,l.useEffect)(()=>{console.log("[Practice] Loading participant ID from localStorage");try{let e=localStorage.getItem("participantId");console.log("[Practice] Stored participant ID:",e),W(e),e?console.log("[Practice] Set participant ID to:",e):console.warn("[Practice] No participantId in localStorage. Did registration run on page load?")}catch(e){console.error("[Practice] Failed to read participantId from localStorage",e)}},[]),(0,l.useEffect)(()=>{if(console.log("[Practice] useEffect triggered, pid:",_),!_){console.log("[Practice] No participant ID available, skipping question loading");return}(async()=>{console.log("[Practice] loadQuestions function called");let e=setTimeout(()=>{console.log("[Practice] Question loading timeout - trying local generation");try{let e=(0,f.cR)("training",6);if(console.log("[Practice] Timeout fallback - generated local questions:",e),e&&e.length>0)D(e),F(!1),R(null);else throw Error("Timeout fallback returned empty questions")}catch(e){console.error("[Practice] Timeout fallback also failed:",e);try{let e=(0,y.t_)(6,{numItems:3,minWeight:2,maxWeight:8,minReward:6,maxReward:24,difficultyLevel:"easy",ensureUniqueSolution:!1});if(e&&e.length>0)D(e),F(!1),R(null);else throw Error("Simple timeout fallback also failed")}catch(e){console.error("[Practice] Simple timeout fallback also failed:",e),R("Question generation timed out. Please refresh the page to try again."),F(!1)}}},1e4);try{console.log("[Practice] Setting isLoadingQuestions to true"),F(!0),R(null),console.log("[Practice] Loading dynamic questions for participant:",_);let t=await (0,p.tY)({participantId:_,phase:"practice",count:6});clearTimeout(e),console.log("[Practice] Loaded questions:",t),D(t)}catch(t){clearTimeout(e),console.error("[Practice] Failed to load questions from backend:",t),R(t instanceof Error?t.message:"Failed to load questions from backend"),console.log("[Practice] Falling back to local question generation");try{console.log("[Practice] Calling createPhaseQuestions('training', 6)");let e=(0,f.cR)("training",6);if(console.log("[Practice] Generated local questions:",e),console.log("[Practice] Number of questions generated:",e.length),e&&e.length>0)D(e),R(null),console.log("[Practice] Successfully set local questions");else throw Error("Local generation returned empty questions array")}catch(e){console.error("[Practice] Local question generation also failed:",e),console.error("[Practice] Local error details:",e);try{console.log("[Practice] Trying simpler question generation approach");let e=(0,y.t_)(6,{numItems:3,minWeight:2,maxWeight:8,minReward:6,maxReward:24,difficultyLevel:"easy",ensureUniqueSolution:!1});if(console.log("[Practice] Simple questions generated:",e),e&&e.length>0)D(e),R(null),console.log("[Practice] Successfully set simple questions");else throw Error("Simple generation also returned empty array")}catch(e){console.error("[Practice] Simple generation also failed:",e),R("Failed to generate questions. Please refresh the page to try again.")}}}finally{clearTimeout(e),console.log("[Practice] Finally block executed - setting isLoadingQuestions to false"),F(!1)}})()},[_]);let A=(0,l.useMemo)(()=>j.env.NEXT_PUBLIC_API_BASE||"https://knapsack-expirement.onrender.com",[]),M=async()=>{if(_)try{F(!0),T(!0),L(!0);let e=await (0,p.tY)({participantId:_,phase:"practice-extra",count:4}),t=[...Z,...e];D(t),N(Z.length),T(null)}catch(e){console.error("[Practice] Failed to load extra questions:",e),T(null)}finally{F(!1)}},G=async()=>{if(!_){alert("Participant not registered yet. Please refresh the page so we can register your session."),console.error("[Practice] handleComplete aborted: no participantId");return}let e=w.filter(e=>e.correct).length,a={phase:"practice",participantId:_,data:{completed:!0,correctAnswers:e,totalQuestions:w.length,accuracy:w.length?e/w.length:0,answers:w}};console.log("[Practice] Submitting payload →",a);try{let e=await fetch("".concat(A,"/api/v1/ingest-phase"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),l=await e.text(),i=null;try{i=JSON.parse(l)}catch(e){}if(console.log("[Practice] ingest-phase status:",e.status,"body:",l),!e.ok)throw Error((null==i?void 0:i.error)||"Failed to submit practice data (status ".concat(e.status,")"));s({training1:a.data}),t()}catch(e){console.error("[Practice] ingest-phase error:",e),console.log("[Practice] Backend unavailable, proceeding with local data only"),s({training1:a.data}),t()}};if(Q)return(0,a.jsx)("div",{className:"max-w-7xl mx-auto p-6",children:(0,a.jsx)(c.Zb,{className:"shadow-lg",children:(0,a.jsx)(c.aY,{className:"p-8 text-center",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl mb-4",children:(0,a.jsx)(o.Z,{className:"h-8 w-8 text-white animate-pulse"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Generating Dynamic Questions"}),(0,a.jsx)("p",{className:"text-gray-600 max-w-md mx-auto",children:"Creating personalized knapsack problems using our sophisticated academic algorithm..."}),(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-500",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),(0,a.jsx)("span",{children:"This may take a few moments"})]}),Y&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:["Error: ",Y,(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-xs",children:"Falling back to backup questions..."})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(i.z,{onClick:()=>{console.log("[Practice] Manual test - generating local questions");try{let e=(0,f.cR)("training",6);if(console.log("[Practice] Test questions generated:",e),e&&e.length>0)D(e),F(!1),R(null),console.log("[Practice] Test questions set successfully");else throw Error("Test generation returned empty array")}catch(e){console.error("[Practice] Test generation failed:",e);try{let e=(0,y.t_)(6,{numItems:3,minWeight:2,maxWeight:8,minReward:6,maxReward:24,difficultyLevel:"easy",ensureUniqueSolution:!1});e&&e.length>0?(D(e),F(!1),R(null),console.log("[Practice] Simple test questions set successfully")):R("Test generation failed - no questions generated")}catch(e){console.error("[Practice] Simple test generation also failed:",e),R("Test generation failed - please check console for details")}}},variant:"outline",size:"sm",children:"Test Local Generation"})})]})})})});if(C)return(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,a.jsxs)(c.Zb,{className:"shadow-lg",children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(d.Z,{className:"h-6 w-6 mr-2 text-green-600"}),"Practice Round - Instructions"]})}),(0,a.jsxs)(c.aY,{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-8",children:[(0,a.jsx)("h3",{className:"text-2xl font-semibold text-green-800 mb-6",children:"Welcome to the Practice Section!"}),(0,a.jsxs)("div",{className:"space-y-6 text-green-700",children:[(0,a.jsxs)("p",{className:"text-lg",children:["In this section, you can practice with dynamically generated questions. You will see a total of",(0,a.jsxs)("strong",{children:[" ",Z.length," questions"]})," to help you get familiar with the knapsack puzzle."]}),Y&&(0,a.jsx)("div",{className:"bg-yellow-100 border border-yellow-300 rounded-lg p-4",children:(0,a.jsxs)("p",{className:"text-yellow-800 text-sm",children:[(0,a.jsx)("strong",{children:"Note:"})," We encountered an issue generating questions dynamically, so we're using backup questions for this session."]})}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold mb-4",children:"\uD83E\uDDE0 Dynamic Generation"}),(0,a.jsxs)("ul",{className:"text-base space-y-2",children:[(0,a.jsx)("li",{children:"• Questions are generated using academic algorithms"}),(0,a.jsx)("li",{children:"• Difficulty controlled by dominance relationships"}),(0,a.jsx)("li",{children:"• Each question has a unique optimal solution"}),(0,a.jsx)("li",{children:"• No time constraint - take your time to learn!"})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold mb-4",children:"\uD83C\uDFAF How to Play"}),(0,a.jsxs)("ul",{className:"text-base space-y-2",children:[(0,a.jsx)("li",{children:"• Click once to select a ball, click again to deselect"}),(0,a.jsx)("li",{children:"• Maximize reward while staying within capacity"}),(0,a.jsx)("li",{children:'• Click "confirm answer" to lock in your selection'}),(0,a.jsx)("li",{children:"• See solutions and explanations after each answer"})]})]})]})]})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(i.z,{onClick:()=>E(!1),size:"lg",className:"bg-green-600 hover:bg-green-700",children:"Start Practice Questions"})})]})]})});if(null!==I){let e=w.filter(e=>e.correct).length,t=(w.length?e/w.length:0)*100;return(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,a.jsxs)(c.Zb,{className:"shadow-lg",children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-6 w-6 mr-2 text-green-600"}),"Practice Complete!"]})}),(0,a.jsx)(c.aY,{className:"space-y-6",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-8 rounded-xl",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Congratulations! You have completed the training."}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:e}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-green-600",children:w.length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-purple-600",children:[t.toFixed(0),"%"]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Accuracy"})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg border-2 border-blue-200 mb-6",children:[(0,a.jsx)("p",{className:"text-lg text-gray-800 mb-4",children:"You should now know how to complete knapsack problems effectively."}),(0,a.jsx)("p",{className:"text-base text-gray-700",children:"From this point on, you will be faced with different tests that are all on completing knapsack problems."})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h4",{className:"font-semibold text-yellow-900 mb-2",children:"Would you like more practice?"}),(0,a.jsx)("p",{className:"text-yellow-800 text-sm mb-4",children:'If you wish to see additional problems, you can press "More Practice" which will allow you to see more knapsack practice questions.'}),(0,a.jsxs)("div",{className:"flex justify-center space-x-3",children:[(0,a.jsx)(i.z,{onClick:G,size:"lg",className:"bg-blue-600 hover:bg-blue-700",children:"Continue to Test 1"}),(0,a.jsx)(i.z,{onClick:M,variant:"outline",size:"lg",children:"More Practice"})]})]})]})})})]})})}if(!Z.length)return(0,a.jsx)("div",{className:"max-w-7xl mx-auto p-6",children:(0,a.jsx)(c.Zb,{className:"shadow-lg",children:(0,a.jsx)(c.aY,{className:"p-8 text-center",children:(0,a.jsx)("div",{className:"text-gray-500",children:"No questions available"})})})});let O=Z[b],U=(b+1)/Z.length*100;return(0,a.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.aY,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:["Practice Question ",b+1," of ",Z.length,z&&b>=6&&" (Extra Practice)"]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(n.C,{variant:"outline",children:"No Time Limit"})})]}),(0,a.jsx)(r.E,{value:U,className:"h-2"})]})}),(0,a.jsx)(h.M,{mode:"wait",children:P?(0,a.jsxs)(x.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"space-y-6",children:[(0,a.jsx)(c.Zb,{className:"border-2 ".concat((null==q?void 0:q.correct)?"border-green-500 bg-green-50":"border-red-500 bg-red-50"),children:(0,a.jsx)(c.aY,{className:"p-6 text-center",children:(null==q?void 0:q.correct)?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(u.Z,{className:"h-12 w-12 text-green-600 mx-auto"}),(0,a.jsx)("h3",{className:"text-xl font-bold text-green-800",children:"Correct!"}),(0,a.jsx)("p",{className:"text-green-700",children:"You found the optimal solution. Great job!"})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(m.Z,{className:"h-12 w-12 text-red-600 mx-auto"}),(0,a.jsx)("h3",{className:"text-xl font-bold text-red-800",children:"Not Quite Right"}),(0,a.jsx)("p",{className:"text-red-700",children:"Don't worry! Let's see the optimal solution below."})]})})}),(0,a.jsx)(g.Z,{question:O,showSolution:!0,isInteractive:!1}),(0,a.jsxs)("div",{className:"text-center space-y-3",children:[(0,a.jsx)(i.z,{onClick:()=>{k(!1),S(null),b<Z.length-1?N(b+1):T(!1)},size:"lg",children:b===Z.length-1?"Complete Practice":"Next Question"}),z&&b>=6&&(0,a.jsx)("div",{children:(0,a.jsx)(i.z,{onClick:G,variant:"outline",size:"lg",className:"ml-4",children:"End Extra Practice & Continue to Test 1"})})]})]},"feedback-".concat(b)):(0,a.jsx)(x.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:(0,a.jsx)(g.Z,{question:O,onAnswer:(e,t)=>{let s={questionId:Z[b].id,selected:e,correct:t};v(e=>[...e,s]),S({selected:e,correct:t}),k(!0)},isInteractive:!0})},"question-".concat(b))})]})}},9388:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}}]);